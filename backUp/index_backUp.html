<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <title>Luciano Candotti | Diseñador Gráfico, Desarrollador Front-End</title>
</head>
<body>
    <!-- nav bar -->
    <nav class="nav navbar shadow-lg navbar-expand-md bg-dark text-light navbar-dark fixed-top">
        <div class="container py-4">
            <a href="#" class="navbar-brand">LUCIANO CANDOTTI</a>
            <button
                class="navbar-toggler rounded-0"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#navmenu">
            <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navmenu">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a href="#grilla" class="nav-link">Proyectos</a>
                    </li>
                    <li class="nav-item">
                        <a href="#about" class="nav-link">About</a>
                    </li>
                    <li class="nav-item">
                        <a href="#contacto" class="nav-link">Contacto</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- intro -->
    <section id="intro">
        <div class="container py-4">
            <h1>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Voluptas sapiente, mollitia aspernatur eveniet rem dolorem odit fugiat nulla quaerat! Deleniti maxime molestias sed adipisci hic.</h1>
        </div>
    </section>
    
    <!-- contenedor de proyecto abierto -->
    <a href="javascript:getClose()"><div id="project"></div></a>

    <!-- contenedor de galería de proyectos -->
    <section id="grilla"></section><div id="output"></div></section>

    <!-- fondop de textura -->
    <div class="texture"></div>

   <script>
    /* función autoinvocada, sin nombre por eso se invoca al final con () */

    (function () { 
        fetch('post.json')
        .then((res) => res.json())
        .then((data) => {
            let output = '';
            data.forEach(function(post){
                /* Construímos los divs con la info + las imgs

                Dentro del div usamos col-lg-4 separa la grilla en 3 en pantalla grande
                col-md-6 separa la grilla en 3 en pantalla mediana, y en pequeño se apila todo a 1 columna
                img-fluid es para que sea flexbox  */

                output += `
                    <div class="col-lg-4 col-md-6 py-3">
                        <div class="card bg-dark p-3 shadow-p-3 rounded-0">
                            <h2 class="py-2 text-light">${post.title}</h2>
                            <a id="${post.id}" href="javascript:getProject('${post.id}')"><img class="img-fluid rounded-0" src="./img/${post.id}/1.png"></a>
                            <p class="pt-3 text-secondary">${post.intro}</p>
                        </div>
                    </div>
                `;
            });
            let grilla =`
                <div class="container py-4">
                    <div class="row">
                        ${output}
                    </div>
                </div>
            `;
            document.getElementById('output').innerHTML = grilla;
        })
    })();


    // Cargamos el proyecto arriba de la grilla
    function getProject(id) {
        fetch('post.json')
        .then((res) => res.json())
        .then((data) => {
            let imgInsert = '';
            // Encontramos el proyecto con id al que hicimos click
            const project = data.find(project => project.id === id);
            
            //console.log(project); // Imprime el proyecto encontrado
            
            // Verificamos que encontramos el proyecto
            if (project) {
                // Cargamos todas las url/img en un string
                for(let img = 1; img <= project.cant; img++) {
                imgInsert += `<img class="img-fluid pb-4" src="./img/${project.id}/${img}.png">`;
                }
                
                // Construimos el contenedor con todas las imágenes
                let grilla = `
                <div class="container pt-5">
                    <h1 class="pb-4 text-light">${project.title}</h1>
                    <h2 class="pb-5 text-light">${project.descript}</h2>
                    <div class="row">
                    ${imgInsert}
                    </div>
                </div>
                `;

                
                document.getElementById('project').innerHTML = grilla;
                location.href = "#project";
                document.body.style.backgroundColor = project.color;
                //window.scroll(0, 250);
            } else {
                console.error(`No se encontró un proyecto con id '${id}'`);
            }
        })
        .catch(error => {
        console.error("Error al cargar los datos:", error);
        });
    };

    function getClose(){
        document.getElementById('project').innerHTML = '';
        //document.body.scrollTop = document.documentElement.scrollTop = 0;
        location.href = "#project";
        document.body.style.backgroundColor = '#0f0f0f';
    }

   </script>


    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
</body>
</html>